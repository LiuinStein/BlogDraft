### 0x00 功能

* 异构网络互连

  > 异构网络指的是**数据链路层和物理层均不同的**网络

* 路由（选择）和（分组）转发

* 拥塞控制

  * 判断拥塞：网络负载增加，网络吞吐量明显小于正常吞吐量，或下降就可能进入了拥塞状态，下降为0，则进入**死锁状态**

  有如下2种方法

  * 开环控制：**静态预防**，力求不产生拥塞
  * 闭环控制：采用监测网络去监测，基于**反馈环路**，是一种**动态的**方法

> 流量控制是点对点之间对**通信量**的控制，拥塞控制是为了确保通信子网**能够传送**待发送的数据

网络层的主要目的是在任意结点之间进行**数据报**传输（不一定是可靠的哦）

### 0x01 路由算法

路由算法可以分为：

* 静态路由算法：又称非自适应路由算法，**人工手动配置**路由表
* 动态路由算法：又称自适应路由算法，相互连接的路由器彼此交换信息

**动态路由算法**又可以分为：

* **距离-向量路由算法**：所有结点**定期**将**整个路由表**传给相邻的结点，最常见的距离向量算法是**RIP算法**
  路由表包含：

  * 路径目的地
  * 路径代价：即跳数，每经过一个路由器跳数+1

  更新路由表的时机：

  * 被告知一条**新的路由**，且该路由在本节点的路由表中不存在
  * 有一个**可以以更小的代价**抵达某一结点的路由信息

  显然更新报文的大小和通信子网的结点数成正比，而且**所有结点都会参加**路由信息交换，通信子网上传递的路由选择信息数量容易变得很大，且此方法有可能遇到**路由环路**的问题

* **链路状态路由算法**：每个参与算法的结点**都有完全的网络拓扑信息**，典型的链路状态算法是**OSPF**算法，链路状态路由算法使用**Dijkstra算法**寻求最短路径，其有如下3个基本特征：

  * 采用**泛洪法**向**本自治系统**中所有结点发送信息，泛洪法就是所有路由器向相邻结点发送信息，然后这些相邻结点又向他们的相邻结点接着发送
  * 发送的信息是**与路由器相连的所有路由器的链路状态**，链路状态指的是链路状态的度量，即为费用、距离、时延、宽带等信息
  * **当链路状态发生变化时**，路由器才向所有路由器发送消息

  其有如下几个优点：

  - **链路状态报文不加以改变**地传输
  - **易于查找故障**
  - 每个路由结点使用同样的原始状态信息**独立地**计算路径，**不依赖中间结点的计算**

两种动态路由算法的比较：

|           | 交谈对象                 | 告知内容                           |
| --------- | ------------------------ | ---------------------------------- |
| 距离-向量 | 直接相邻结点             | 从自己到**其他所有结点**的最低代价 |
| 链路状态  | 广播的方式与其他所有结点 | 与它**直接相连的链路**的代价       |

层次路由：将互联网划分为许多小的**自治系统**（每个自治系统包含很多局域网），每个自治系统**有权决定内部的路由选择协议（内部网关协议IGP）**，自治系统之间使用**外部网关协议（EGP）**

IGP有**RIP和OSPF**两种协议，EGP有**BGP协议**。

路由器的交付：

* 直接交付：直接给当前路由器所连主机
* 间接交付：还需要跳跃路由器

判断是直接交付还是间接交付：将分组的**源IP地址**与**目的IP地址**分别与**子网掩码**进行**与操作**，如果得到的**子网地址**相同，则使用直接交付，否则使用间接交付

> 此处的分组的源IP地址也就是**路由器接收端口的IP地址**

**路由收敛**指网络的拓扑结构发生变化后，**路由表重新建立到发送再到学习直至稳定，并通告网络中所有相关路由器都得知该变化的过程**。也就是网络拓扑变化引起的通过重新计算路由而发现替代路由的行为。


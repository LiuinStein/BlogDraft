### 0x00 常用常数

|      名称      |     数值      |
| :------------: | :-----------: |
|  以太网帧帧长  |     1500B     |
|   IP头部长度   |      20B      |
| 以太网有效载荷 | 1500-20=1480B |
|  TCP首部长度   |      20B      |
|  UDP首部长度   |      8B       |
| TCP伪首部长度  |      12B      |
| UDP伪首部长度  |      20B      |
|                |               |
|                |               |



### 0x01 数据链路层

**最小帧长的计算**：
$$
最小帧长=总线传播时延\times数据传输速率\times 2 \\
收到小于最小帧长的帧将会被全部丢弃 \\
总传播时延是双向的，也就是一趟去一趟回来的\\
\mathbf{\large 最小帧长实质为在争用期发出的比特数}
$$

**链路利用率**：
$$
链路利用率=\frac{t_{发送数据}}{t_{发送数据}+k\cdot t_{单向传播延迟}}\\
其中k为系数，当链路使用停止-等待协议时，k=2 \\
当链路采用滑动窗口协议时，k=1
$$

**CSMA/CD的二进制指数退避算法**：

- 确定基本退避时间，一般为2倍总线端到端的传播时延2$\tau$
- 定义k为重传次数，但k不超过10，**当重传次数大于10时k就一直取10**
- 从离散的整数集合{0,1,...,$2^k-1$}中随机取一个数r，重传所需要的退避时间就是r倍的基本退避时间，即$2\tau r$
- 当重传16次还不成功时，**抛弃此帧，向高层报告**

### 0x02 传输层

**最大吞吐量的计算**：

达到最大吞吐量时，系统接收到确认之后立即发送下一报文段，所以：
$$
最大吞吐量=\frac{发送数据量}{t_{往返时延}+t_{发送时延}}\\
其中t_{往返时延}=2t_{端到端时延}
$$

> 需要加上往返时延的原因是因为发送过去之后，对方接着发回一个确认

